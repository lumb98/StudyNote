# 汇编和寄存器

记录学习中学到的一些寄存器和汇编命令

## 汇编命令

### `BL`调用函数

下面的代码含义就是调用`main`函数

```assembly
RL main
```

调用这行代码会做两件事，分别是

1. LR=返回地址(实际上就是下一行代码的地址)
2. 执行main

会保存LR等寄存器的值，局部变量等，将这些东西存入栈中。



### LDR(load)从内存中读取放入寄存器

```assembly
LDR rO, [addr A] ; 从内存地址A中读取 4个字节 的数据存入r0寄存器中
LDRH rO, [addr A] ; 从内存地址A中读取 2个字节 的数据存入r0寄存器中
LDRB rO, [addr A] ; 从内存地址A中读取 1个字节 的数据存入r0寄存器中

LDR r2, [r0,#0x00] ; 从r0+0x00的地址读取 4个字节 的数据存入r2寄存器中
```



### STR(store)将寄存器中的数据存如内存

```assembly
STR rO, [addr A] ; 将r0寄存器中的值存入 内存中A地址

STR r2, [sp,#0x00] ; 将r0寄存器中的值存入 内存sp+0x00地址
```



### ADD 加指令

```assembly
ADD r0,r1,r2 ; r0=r1+r2
```

### SUB减指令

```assembly
SUB r0,
```



### PUSH指令

入栈，入栈的本质是写内存

越靠后的写进栈的越高地址(0x100)，越靠前的写进越低地址(0x00)，要注意栈是从高地址开始的，每次入栈地址会越来越低。实际上就是**从后往前存**。

```assembly
PUSH {r3,lr} ; 将r3,LR寄存器的值写入sp所指定的位置，
;分解
sp=r3
sp=sp-4
sp=lr
sp=sp-4
```



### POP指令

弹栈，弹栈的本质是读内存

```assembly
POP {r3,pc} ; 从内存SP指定的地址中读取值，赋给r3和PC
; 分解
r3=[sp]
sp=sp+4
pc=sp
sp=sp+4
```







从内存中将a的值读到寄存器R0中。







## ARM寄存器

### ARM架构讲解

SoC: System on chip

主要由几部分组成，分别是 CPU、RAM、Flash和UART等外设。

其中CPU进行各种运算，RAM存放运行中的数据，就是ARM架构的内存，Flash用来存放代码



R13 别名SP 堆栈指针寄存器

R14 别名LR 返回地址

R15 别名PC 当前指令地址

R0-R15 用于存放从内存中读出的数据。